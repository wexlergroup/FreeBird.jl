<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interface with Python for MLIPs · FreeBird.jl</title><meta name="title" content="Interface with Python for MLIPs · FreeBird.jl"/><meta property="og:title" content="Interface with Python for MLIPs · FreeBird.jl"/><meta property="twitter:title" content="Interface with Python for MLIPs · FreeBird.jl"/><meta name="description" content="Documentation for FreeBird.jl."/><meta property="og:description" content="Documentation for FreeBird.jl."/><meta property="twitter:description" content="Documentation for FreeBird.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FreeBird.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FreeBird.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">FreeBird.jl</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Interface with Python for MLIPs</a><ul class="internal"><li><a class="tocitem" href="#UMA"><span>UMA</span></a></li><li><a class="tocitem" href="#MACE"><span>MACE</span></a></li><li><a class="tocitem" href="#ORB"><span>ORB</span></a></li><li><a class="tocitem" href="#Add-other-MLIPs"><span>Add other MLIPs</span></a></li><li><a class="tocitem" href="#Using-MLIPs-for-nested-sampling"><span>Using MLIPs for nested sampling</span></a></li></ul></li><li><span class="tocitem">Modules and Documentation</span><ul><li><a class="tocitem" href="../AbstractLiveSets/"><code>AbstractLiveSets</code></a></li><li><a class="tocitem" href="../AbstractWalkers/"><code>AbstractWalkers</code></a></li><li><a class="tocitem" href="../SamplingSchemes/"><code>SamplingSchemes</code></a></li><li><a class="tocitem" href="../AbstractPotentials/"><code>AbstractPotentials</code></a></li><li><a class="tocitem" href="../AbstractHamiltonians/"><code>AbstractHamiltonians</code></a></li><li><a class="tocitem" href="../EnergyEval/"><code>EnergyEval</code></a></li><li><a class="tocitem" href="../MonteCarloMoves/"><code>MonteCarloMoves</code></a></li><li><a class="tocitem" href="../FreeBirdIO/"><code>FreeBirdIO</code></a></li><li><a class="tocitem" href="../AnalysisTools/"><code>AnalysisTools</code></a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Interface with Python for MLIPs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interface with Python for MLIPs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wexlergroup/FreeBird.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wexlergroup/FreeBird.jl/blob/main/docs/src/MLIPs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-Machine-Learning-Interatomic-Potentials-(MLIPs)-in-FreeBird"><a class="docs-heading-anchor" href="#Using-Machine-Learning-Interatomic-Potentials-(MLIPs)-in-FreeBird">Using Machine Learning Interatomic Potentials (MLIPs) in FreeBird</a><a id="Using-Machine-Learning-Interatomic-Potentials-(MLIPs)-in-FreeBird-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Machine-Learning-Interatomic-Potentials-(MLIPs)-in-FreeBird" title="Permalink"></a></h1><p>FreeBird.jl supports the use of machine learning interatomic potentials (MLIPs) by interfacing with the ASE (Atomic Simulation Environment) Python calculators. One can use your local Python environment or set up a Conda environment within Julia using <code>CondaPkg.jl</code>.</p><h2 id="UMA"><a class="docs-heading-anchor" href="#UMA">UMA</a><a id="UMA-1"></a><a class="docs-heading-anchor-permalink" href="#UMA" title="Permalink"></a></h2><p>For UMA, we recommend setting up a local Conda environment. For example:</p><pre><code class="language-bash hljs"># This is a bash command, run it in your terminal before starting Julia
conda create -prefix ./uma_env python=3.11
conda activate ./uma_env
pip install fairchem-core</code></pre><p>Now, start Julia with the Conda environment activated, and use <code>PreferenceTools.jl</code> to set the <code>PYTHON</code> environment variable to point to the Python executable in your Conda environment:</p><pre><code class="language-julia hljs">using PreferenceTools
# press the &quot;]&quot; key to enter Pkg mode
pkg&gt; preference add CondaPkg env=/full/path/to/uma_env</code></pre><p>Replace <code>/full/path/to/uma_env</code> with the actual path to your Conda environment. You only need to do this once.</p><p>Now, we can use UMA MLIPs in FreeBird.jl. Here is an example of setting up an <code>MLIPAtomWalkers</code> live set:</p><pre><code class="language-julia hljs">using FreeBird
mlp = PyMLPotential(model_type=&quot;uma&quot;, model_version=&quot;uma-s-1p1&quot;, task_name=&quot;omol&quot;, use_gpu=false)
walkers = AtomWalker.(generate_initial_configs(10, 562.5, 6; particle_type=:Si))
ls = MLIPAtomWalkers(walkers, mlp)</code></pre><h2 id="MACE"><a class="docs-heading-anchor" href="#MACE">MACE</a><a id="MACE-1"></a><a class="docs-heading-anchor-permalink" href="#MACE" title="Permalink"></a></h2><p>Similarly, for MACE, you can set up a Conda environment and direct CondaPkg.jl to use it. </p><p>Alternatively, you can install the required packages within your Julia environment using CondaPkg.jl:</p><pre><code class="language-julia hljs">using CondaPkg
# press the &quot;]&quot; key to enter Pkg mode
pkg&gt; conda pip_add mace-torch</code></pre><p>To enable CUDA acceleration with cuEquivariance library, you need to install additional packages:</p><pre><code class="language-julia hljs">pkg&gt; conda pip_add cuequivariance cuequivariance-torch cuequivariance-ops-torch-cu12</code></pre><p>See <a href="https://mace.readthedocs.io/en/latest/">MACE documentation</a> for more details on installation and usage.</p><p>Now, we can use MACE MLIPs in FreeBird.jl. Here is an example of setting up an <code>MLIPAtomWalkers</code> live set:</p><pre><code class="language-julia hljs">using FreeBird
# Create MACE potential using the &quot;small&quot; pre-trained model, you can supply your own model path as well
mlp = PyMLPotential(model_type=&quot;mace&quot;, model_version=&quot;small&quot;, float_type=&quot;float32&quot;, use_gpu=false)
walkers = AtomWalker.(generate_initial_configs(10, 562.5, 6; particle_type=:Si))
ls = MLIPAtomWalkers(walkers, mlp)</code></pre><h2 id="ORB"><a class="docs-heading-anchor" href="#ORB">ORB</a><a id="ORB-1"></a><a class="docs-heading-anchor-permalink" href="#ORB" title="Permalink"></a></h2><p>Again, you can point CondaPkg.jl to your local Conda environment where you have installed ORB.  Alternatively, you can install the required packages within your Julia environment using CondaPkg.jl:</p><pre><code class="language-julia hljs">using CondaPkg
# press the &quot;]&quot; key to enter Pkg mode
pkg&gt; conda pip_add orb-models</code></pre><p>Now, we can use ORB MLIPs in FreeBird.jl. Here is an example of setting up an <code>MLIPAtomWalkers</code> live set:</p><pre><code class="language-julia hljs">using FreeBird
mlp = PyMLPotential(model_type=&quot;orb&quot;, model_version=&quot;n&quot;, float_type=&quot;float32-high&quot;, use_gpu=false)</code></pre><h2 id="Add-other-MLIPs"><a class="docs-heading-anchor" href="#Add-other-MLIPs">Add other MLIPs</a><a id="Add-other-MLIPs-1"></a><a class="docs-heading-anchor-permalink" href="#Add-other-MLIPs" title="Permalink"></a></h2><p>In principle, you can use any ASE-compatible MLIP by creating a new <code>PyMLPotential</code> dispatch in the <code>FreeBird.AbstractPotentials</code> module. Specially, in <code>src/AbstractPotentials/ase_calculators.jl</code>, you can add a new function similar to the existing ones for UMA, MACE, and ORB.</p><p>Using MACE as an example, you can create a new potential as follows:</p><pre><code class="language-julia hljs">function PyMLPotential(;model_version::String, 
                        float_type::String=&quot;&quot;,
                        use_gpu::Bool=false)
    # import relevant Python module
    mace = pyimport(&quot;mace.calculators&quot;)
    # create MACE ASE calculator using an appropriate function call
    mace_calc = mace.mace_mp(model=model_version, default_dtype=float_type, enable_cueq=use_gpu)
    # wrap and return as PyMLPotential
    return PyMLPotential(ASEcalculator(mace_calc))
end</code></pre><p>FreeBird.jl will then be able to use this new MLIP for evaluating energies, which is defined in the <code>FreeBird.EnergyEval</code> module. Such as:</p><pre><code class="language-julia hljs">function interacting_energy(system::AbstractSystem, calc::PyMLPotential)
    return AtomsCalculators.potential_energy(system, calc.calc)
end</code></pre><h2 id="Using-MLIPs-for-nested-sampling"><a class="docs-heading-anchor" href="#Using-MLIPs-for-nested-sampling">Using MLIPs for nested sampling</a><a id="Using-MLIPs-for-nested-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Using-MLIPs-for-nested-sampling" title="Permalink"></a></h2><p>Here, we provide an example of using ORB MLIP for nested sampling with <code>MLIPAtomWalkers</code> live set.</p><pre><code class="language-julia hljs">using FreeBird

# Set up ORB potential
mlp = PyMLPotential(model_type=&quot;orb&quot;, model_version=&quot;n&quot;, float_type=&quot;float32-high&quot;, use_gpu=false)

# Generate initial configurations and set up walkers, let&#39;s say 10 walkers of 6 Si atoms in a box
walkers = AtomWalker.(generate_initial_configs(10, 562.5, 6; particle_type=:Si))

# Set up MLIPAtomWalkers live set, energies will be evaluated using the ORB potential
ls = MLIPAtomWalkers(walkers, mlp)

# Set up nested sampling parameters, using 100 MC steps per iteration and small step sizes
ns_params = NestedSamplingParameters(mc_steps=100, step_size=0.01, step_size_up=0.05, random_seed=1234*rand(Int))

# Set up output saving parameters
save = SaveEveryN(n_traj=10, n_snap=10_000, n_info=1)

# Set up Monte Carlo routines
mc = MCRandomWalkClone() # works with MLIPAtomWalkers on a GPU or CPU; one can use `MCDistributed()` for multi-processing on CPU (no GPU support yet)

# Run nested sampling for 10_000 iterations
energies, liveset, _ = nested_sampling(ls, ns_params, 10_000, mc, save)</code></pre><p>Fundamentally, using other MLIPs follows the same procedure as above. Be aware of the computational costs with MLIPS, one typically needs to use GPU for fast energy evaluations, or massively parallel CPU computations to distribute the workload.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><a class="docs-footer-nextpage" href="../AbstractLiveSets/"><code>AbstractLiveSets</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 10 December 2025 17:30">Wednesday 10 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
